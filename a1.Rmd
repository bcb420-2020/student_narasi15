---
title: "Assignment 1: Data Set Selection and Initial Processing"
author: "Priyanka Narasimhan"
output: html
---

# This R Notebook will provide insight on the initial preparation and analysis of the dataset GSE136864. 
# Resources: Sample code from lectures 3 & 4, and RPR-GEO2R.R file from Prof. Streipe was used.

# 0 - Install and load additional packages like BiocManager, BioBase, & GEOquery
```{r}
rm(list = ls())
if (! requireNamespace("BiocManager", quietly = TRUE)) {
  install.packages("BiocManager")
}
if (! requireNamespace("Biobase", quietly = TRUE)) {
  BiocManager::install("Biobase")
}
if (! requireNamespace("GEOquery", quietly = TRUE)) {
  BiocManager::install("GEOquery")
}
# Load
library(BiocGenerics)
library(Biobase)
library(GEOquery)
```

# 1 - Download the dataset from GEO
```{r}
gset <- GEOquery::getGEO("GSE136864", GSEMatrix =TRUE)

# Some additional info:
length(gset) # the length is 1
edata <- gset[[1]]
edata # This is our expression matrix

# Our phenodata returns a dataframe that shows our 17 GEO samples, and 49 variable (column) labels
names = (pData(edata))
names
```

# Download Supplementary file(s), there is only 1 
```{r}
supfile <- NULL
sfilename="GSE136864_elf1_counts_matrix.txt.gz" 

# Don't download if supp. file already exists
if (!file.exists(sfilename)) {
    supfile <- getGEOSuppFiles('GSE136864')
 } 

fnames = rownames(supfile)
fnames
```

# 2 - Assessing the Dataset 
Uniprot tells us: ETS-related transcription factor Elf-1 is a protein, gene name is ELF1
Definition 1: A transcription factor is a protein that controls the rate of transcription
Definition 2: A type I interferon (IFN) is a subgroup of proteins that help regulate the activity of the immune system 

This particular dataset studies the transcription factor ELF1, and it's effect in inbihiting replication of viral
infections (like influenza), independent of type I interferons. 
I was particularly interested in this dataset due to recent events and outbreaks of the corona virus. Hence I wanted to choose a topic related to viral infections and/or human body immune system. 
 
# Some general information about this platform:

```{r}
gse <- getGEO("GSE136864", GSEMatrix=FALSE)
current_gpl <- names(GPLList(gse))[1]
current_gpl_info <- Meta(getGEO(current_gpl))
```

**Platform title:** `r current_gpl_info$title`
**Submission date:** `r current_gpl_info$submission_date`
**Last updated date:** `r current_gpl_info$last_update_date`
**Organism:** `r current_gpl_info$organism`
**Number of GEO datasets that use this technology:** `r length(current_gpl_info$series_id)`
**Number of GEO samples that use this technology:** `r length(current_gpl_info$sample_id)`

# Experimental Design:

A549 cells (which are found in lung tissue), were used in the experiment. These cells were either:
- not-transduced 
- or transduced with empty vector, ELF1-WT, or ELF1-R8A mutant. 
In addition, indicated cultures were stimulated with interferon beta for 6 hours or 48 hours. 
All samples were harvested simultaneously and analyzed by RNA-Seq

# Get some data about the supplementary files
```{r}
sfiles = getGEOSuppFiles('GSE136864')
counts = read.delim(rownames(sfiles)[1],header=TRUE, check.names = FALSE)
head(counts)
```

```{r}
dim(counts) # returns [1] 63678    18
```

```{r}
# Define groups, using 1, 3, and 2 token after split string
# "Transduced" column - either empty, ELF1, cell or R8A
# "trial_num" - pretty self explanatory
# "mock_or_IFN" - mock means no stimulation with IFN

samples <- data.frame(lapply(colnames(counts)[2:18],
                             FUN = function(x) {
                               unlist(strsplit(x, split="_"))[c(1, 3, 2)]
                             }))
colnames(samples) <- colnames(counts)[2:18]
rownames(samples) <- c("Transduced", "trial_num", "mock_or_IFN")
samples <- data.frame(t(samples))
samples

```


# 3 - Map to HUGO symbols

# 4 - Clean the data

# 5 - Normalize the data

# References



